.PHONY: help install backend frontend run stop clean

help:
	@echo "========================================"
	@echo "Plataforma Inteligente de Atletas"
	@echo "========================================"
	@echo ""
	@echo "Comandos disponÃ­veis:"
	@echo "  make install    - Instala todas as dependÃªncias"
	@echo "  make backend    - Inicia apenas o backend"
	@echo "  make frontend   - Inicia apenas o frontend"
	@echo "  make run        - Inicia backend e frontend"
	@echo "  make init-db    - Inicializa o banco de dados"
	@echo "  make clean      - Limpa arquivos temporÃ¡rios"
	@echo ""

install:
	@echo "ðŸ“¦ Instalando dependÃªncias..."
	@echo "Backend..."
	cd backend && pip install -r requirements.txt
	@echo "Frontend..."
	cd frontend && npm install
	@echo "âœ… DependÃªncias instaladas!"

init-db:
	@echo "ðŸ—„ï¸  Inicializando banco de dados..."
	cd backend && python init_db.py
	@echo "âœ… Banco de dados inicializado!"

backend:
	@echo "ðŸš€ Iniciando backend..."
	cd backend && uvicorn main:app --reload

frontend:
	@echo "ðŸš€ Iniciando frontend..."
	cd frontend && npm start

run: init-db
	@echo "ðŸš€ Iniciando plataforma completa..."
	@echo ""
	@echo "Backend: http://localhost:8000"
	@echo "Frontend: http://localhost:3000"
	@echo ""
	@echo "Pressione Ctrl+C para parar"
	@echo ""
ifeq ($(OS),Windows_NT)
	@start cmd /k "cd backend && uvicorn main:app --reload"
	@timeout /t 3 /nobreak >nul
	@start cmd /k "cd frontend && npm start"
	@timeout /t 5 /nobreak >nul
	@start http://localhost:3000
	@echo "âœ… Plataforma iniciada! Navegador aberto."
else
	@cd backend && uvicorn main:app --reload &
	@sleep 3
	@cd frontend && npm start &
	@sleep 5
	@xdg-open http://localhost:3000 2>/dev/null || open http://localhost:3000 2>/dev/null || echo "Abra http://localhost:3000 no navegador"
	@echo "âœ… Plataforma iniciada!"
	@echo "Pressione Ctrl+C para parar"
	@wait
endif

clean:
	@echo "ðŸ§¹ Limpando arquivos temporÃ¡rios..."
	@rmdir /s /q backend\__pycache__ 2>nul || true
	@rmdir /s /q backend\*.pyc 2>nul || true
	@rmdir /s /q frontend\node_modules 2>nul || true
	@echo "âœ… Limpeza concluÃ­da!"

